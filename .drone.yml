pipeline:
  build:
    image: plugins/docker
    repo: mtimoustafa/minecraft-box
    username:
      from_secret: docker_username
    password:
      from_secret: docker_password
    tags:
      - ${DRONE_COMMIT_BRANCH}
    when:
      event: push

  deploy:
    commands:
      - ecs update-service --cluster minecraft-box-cluster --service minecraft-box-service --force-new-deployment
    when:
      branch: master
      event: push

